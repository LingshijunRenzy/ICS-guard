import{d as N,r as g,A as R,o as z,a as f,b as s,w as B,q as t,s as n,x as r,$ as M,u as P,v as Y,G as j,C as q,a0 as F,E as G,F as w,f as C,e as V,t as p,n as E,l as d,_ as H}from"./index-qxG7-ExM.js";const J={class:"view-container"},K={class:"cyber-card"},W={class:"filter-bar"},$={class:"mono-text"},Q={class:"json-preview"},X={class:"pagination-container"},Z=N({__name:"AutomationLogsView",setup(ee){const _=g(!1),m=g([]),y=g(0),l=R({page:1,per_page:20,type:"",severity:"",resource:""}),k=[{label:"全部类型",value:""},{label:"网络状态",value:"network_status_update"},{label:"流量异常",value:"traffic_anomaly"},{label:"蜜罐交互",value:"honeypot_interaction"},{label:"拓扑变更",value:"topology_change"},{label:"流更新",value:"flow_update"}],x=[{label:"全部等级",value:""},{label:"Info",value:"info"},{label:"Warning",value:"warning"},{label:"High",value:"high"},{label:"Critical",value:"critical"}];async function u(){_.value=!0;try{const a=await F({page:l.page,per_page:l.per_page,type:l.type||void 0,severity:l.severity||void 0,resource:l.resource||void 0});m.value=a.items,y.value=a.total}catch(a){console.error(a),G.error("加载日志失败")}finally{_.value=!1}}function c(){l.page=1,u()}function S(a){l.page=a,u()}function A(a){if(!a)return"-";try{const o=JSON.parse(a);return JSON.stringify(o,null,2)}catch{return a}}function D(a){return a==="traffic_anomaly"?"cli-tag-dangerous":a==="honeypot_interaction"?"cli-tag-suspicious":a==="network_status_update"?"cli-tag-primary":a==="flow_detection"?"cli-tag-secondary":"cli-tag-info"}return z(()=>{u()}),(a,o)=>{const b=r("el-option"),h=r("el-select"),I=r("el-input"),v=r("el-button"),i=r("el-table-column"),T=r("el-popover"),L=r("el-table"),O=r("el-pagination"),U=j("loading");return d(),f("div",J,[s("div",K,[o[5]||(o[5]=s("div",{class:"card-header"},[s("div",{class:"header-title"},"AUTOMATION LOGS // 自动化操作记录")],-1)),s("div",W,[t(h,{modelValue:l.type,"onUpdate:modelValue":o[0]||(o[0]=e=>l.type=e),placeholder:"事件类型",style:{width:"180px"},onChange:c},{default:n(()=>[(d(),f(w,null,C(k,e=>t(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(h,{modelValue:l.severity,"onUpdate:modelValue":o[1]||(o[1]=e=>l.severity=e),placeholder:"严重等级",style:{width:"140px"},onChange:c},{default:n(()=>[(d(),f(w,null,C(x,e=>t(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(I,{modelValue:l.resource,"onUpdate:modelValue":o[2]||(o[2]=e=>l.resource=e),placeholder:"资源ID (如 flow_id)",style:{width:"200px"},clearable:"",onKeyup:M(c,["enter"])},null,8,["modelValue"]),t(v,{type:"primary",onClick:c},{default:n(()=>[...o[3]||(o[3]=[V("SEARCH",-1)])]),_:1}),t(v,{icon:P(Y),circle:"",onClick:u,title:"刷新"},null,8,["icon"])]),B((d(),q(L,{data:m.value,style:{width:"100%"},class:"cyber-table"},{default:n(()=>[t(i,{prop:"id",label:"ID",width:"80"}),t(i,{prop:"timestamp",label:"TIME",width:"180"},{default:n(({row:e})=>[s("span",$,p(new Date(e.timestamp).toLocaleString()),1)]),_:1}),t(i,{prop:"type",label:"TYPE",width:"180"},{default:n(({row:e})=>[s("div",{class:E(["cli-tag",D(e.type)])},p(e.type),3)]),_:1}),t(i,{prop:"severity",label:"SEVERITY",width:"100"},{default:n(({row:e})=>[s("span",{class:E(`severity-${e.severity}`)},p(e.severity.toUpperCase()),3)]),_:1}),t(i,{prop:"resource",label:"RESOURCE",width:"200","show-overflow-tooltip":""}),t(i,{prop:"source",label:"SOURCE",width:"120"}),t(i,{label:"PAYLOAD","min-width":"300"},{default:n(({row:e})=>[t(T,{placement:"left",width:400,trigger:"click"},{reference:n(()=>[t(v,{link:"",type:"primary",size:"small"},{default:n(()=>[...o[4]||(o[4]=[V("VIEW DETAILS",-1)])]),_:1})]),default:n(()=>[s("pre",Q,p(A(e.payload)),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[U,_.value]]),s("div",X,[t(O,{background:"",layout:"prev, pager, next",total:y.value,"page-size":l.per_page,"current-page":l.page,onCurrentChange:S},null,8,["total","page-size","current-page"])])])])}}}),ae=H(Z,[["__scopeId","data-v-b7ec46e3"]]);export{ae as default};
