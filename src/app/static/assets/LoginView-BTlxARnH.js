import{d as V,a1 as v,r as b,A as x,a as C,b as n,q as t,s as a,$ as h,x as l,e as _,E as m,a2 as k,a3 as B,a4 as E,a5 as N,l as S,_ as U}from"./index-qxG7-ExM.js";const q={class:"login-page"},A={class:"login-card"},I=V({__name:"LoginView",setup(K){const f=N(),w=E(),p=v(),r=b(!1),s=x({username:"admin",password:"admin"});async function c(){if(!s.username||!s.password){m.error("请输入用户名和密码");return}r.value=!0;try{const u=await k.post("/auth/login",{username:s.username,password:s.password});p.setToken(u.data.access_token);try{const o=await B();p.setPermissions(o.permissions||[])}catch{}m.success("登录成功");const e=w.query.redirect||"/";f.push(e)}catch{m.error("登录失败，请检查用户名或密码")}finally{r.value=!1}}return(u,e)=>{const o=l("el-input"),i=l("el-form-item"),g=l("el-button"),y=l("el-form");return S(),C("div",q,[n("div",A,[e[4]||(e[4]=n("div",{class:"login-title"},"ICS-Guard 控制台",-1)),t(y,{"label-width":"80px",onKeyup:h(c,["enter"])},{default:a(()=>[t(i,{label:"用户名"},{default:a(()=>[t(o,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=d=>s.username=d),autocomplete:"username"},null,8,["modelValue"])]),_:1}),t(i,{label:"密码"},{default:a(()=>[t(o,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=d=>s.password=d),type:"password",autocomplete:"current-password"},null,8,["modelValue"])]),_:1}),t(i,null,{default:a(()=>[t(g,{type:"primary",loading:r.value,style:{width:"100%"},onClick:c},{default:a(()=>[...e[2]||(e[2]=[_(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),e[3]||(e[3]=n("div",{class:"login-hint"},[_(" 默认账户："),n("code",null,"admin / admin")],-1))]),_:1})])])}}}),R=U(I,[["__scopeId","data-v-96cdfc2a"]]);export{R as default};
