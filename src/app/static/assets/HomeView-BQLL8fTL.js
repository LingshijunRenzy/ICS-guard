import{d as A,r as n,c as d,o as O,a as o,b as s,t as a,e as I,n as h,F as m,f,g as C,h as R,i as k,j as w,k as V,l as i,_ as D}from"./index-qxG7-ExM.js";const M={class:"dashboard-container"},H={class:"bento-grid"},x={class:"bento-card stat-card cyber-border"},Y={class:"card-inner"},F={class:"stat-value"},G={class:"stat-sub"},P={class:"highlight-green"},B={class:"bento-card stat-card cyber-border"},U={class:"card-inner"},W={class:"stat-sub"},j={class:"highlight-red"},q={class:"bento-card stat-card cyber-border"},z={class:"card-inner"},J={class:"stat-value"},K={class:"bento-card stat-card cyber-border"},Z={class:"card-inner"},Q={class:"stat-sub"},X={class:"bento-card wide-card cyber-border span-2"},$={class:"card-content scrollable-list"},ss={key:0,class:"empty-state"},es={class:"item-time"},ts={class:"item-level"},as={class:"item-msg"},ls={class:"bento-card wide-card cyber-border span-2"},os={class:"card-content scrollable-list"},is={key:0,class:"empty-state"},ns={class:"item-time"},ds={class:"item-source"},rs={class:"item-target"},cs={class:"item-proto"},vs={class:"bento-card full-width-card cyber-border span-4"},us={class:"card-content events-grid"},_s={class:"event-time"},ps={class:"event-type"},hs={class:"event-data"},ms=A({__name:"HomeView",setup(fs){const c=n({nodes:[],links:[]}),r=n([]),v=n([]),_=n(null),b=n([]),T=n(!0),N=d(()=>c.value.nodes.length);d(()=>c.value.links.length);const S=d(()=>c.value.nodes.filter(l=>l.status==="online").length),p=d(()=>r.value.filter(l=>l.level==="critical"||l.level==="high").length),L=d(()=>v.value.length),y=d(()=>p.value>0?"WARNING":_.value?.loaded?"NORMAL":"INITIALIZING"),g=async()=>{T.value=!0;try{const[l,e,t,u,E]=await Promise.allSettled([C(),R(),k(),w(),V({limit:20})]);l.status==="fulfilled"&&(c.value=l.value),e.status==="fulfilled"&&(r.value=e.value),t.status==="fulfilled"&&(v.value=t.value),u.status==="fulfilled"&&(_.value=u.value),E.status==="fulfilled"&&(b.value=E.value.items)}catch(l){console.error("Failed to load dashboard data",l)}finally{T.value=!1}};return O(()=>{g(),setInterval(g,3e4)}),(l,e)=>(i(),o("div",M,[s("div",H,[s("div",x,[s("div",Y,[e[1]||(e[1]=s("div",{class:"stat-label"},"NETWORK NODES",-1)),s("div",F,a(N.value),1),s("div",G,[e[0]||(e[0]=I("ONLINE: ",-1)),s("span",P,a(S.value),1)])]),e[2]||(e[2]=s("div",{class:"card-decoration-corner"},null,-1))]),s("div",B,[s("div",U,[e[4]||(e[4]=s("div",{class:"stat-label"},"ACTIVE ALERTS",-1)),s("div",{class:h(["stat-value",{"text-danger":p.value>0}])},a(r.value.length),3),s("div",W,[e[3]||(e[3]=I("CRITICAL: ",-1)),s("span",j,a(p.value),1)])]),e[5]||(e[5]=s("div",{class:"card-decoration-corner"},null,-1))]),s("div",q,[s("div",z,[e[6]||(e[6]=s("div",{class:"stat-label"},"HONEYPOT HITS",-1)),s("div",J,a(L.value),1),e[7]||(e[7]=s("div",{class:"stat-sub"},"LAST 24H",-1))]),e[8]||(e[8]=s("div",{class:"card-decoration-corner"},null,-1))]),s("div",K,[s("div",Z,[e[9]||(e[9]=s("div",{class:"stat-label"},"SYSTEM STATUS",-1)),s("div",{class:h(["stat-value status-text",y.value.toLowerCase()])},a(y.value),3),s("div",Q,"MODEL: "+a(_.value?.loaded?"ACTIVE":"OFFLINE"),1)]),e[10]||(e[10]=s("div",{class:"card-decoration-corner"},null,-1))]),s("div",X,[e[11]||(e[11]=s("div",{class:"card-header"},[s("span",{class:"header-title"},">> RECENT ALERTS"),s("span",{class:"header-decoration"},"/// MONITORING")],-1)),s("div",$,[r.value.length===0?(i(),o("div",ss,"NO ACTIVE ALERTS")):(i(!0),o(m,{key:1},f(r.value.slice(0,5),t=>(i(),o("div",{key:t.id,class:h(["list-item alert-item",t.level])},[s("span",es,a(new Date(t.created_at).toLocaleTimeString()),1),s("span",ts,"["+a(t.level.toUpperCase())+"]",1),s("span",as,a(t.message),1)],2))),128))])]),s("div",ls,[e[13]||(e[13]=s("div",{class:"card-header"},[s("span",{class:"header-title"},">> HONEYPOT ACTIVITY"),s("span",{class:"header-decoration"},"/// TRAP LOGS")],-1)),s("div",os,[v.value.length===0?(i(),o("div",is,"NO ACTIVITY DETECTED")):(i(!0),o(m,{key:1},f(v.value.slice(0,5),t=>(i(),o("div",{key:t.id,class:"list-item honey-item"},[s("span",ns,a(new Date(t.timestamp).toLocaleTimeString()),1),s("span",ds,a(t.src_ip),1),e[12]||(e[12]=s("span",{class:"item-arrow"},"->",-1)),s("span",rs,a(t.dst_ip),1),s("span",cs,a(t.request.split(" ")[0]||"TCP"),1)]))),128))])]),s("div",vs,[e[14]||(e[14]=s("div",{class:"card-header"},[s("span",{class:"header-title"},">> SYSTEM EVENT LOG")],-1)),s("div",us,[(i(!0),o(m,null,f(b.value.slice(0,6),(t,u)=>(i(),o("div",{key:u,class:"event-pill"},[s("span",_s,a(new Date(t.timestamp).toLocaleTimeString()),1),s("span",ps,a(t.type),1),s("span",hs,a(JSON.stringify(t.data).slice(0,50))+"...",1)]))),128))])])])]))}}),Ts=D(ms,[["__scopeId","data-v-0afd70a7"]]);export{Ts as default};
